% Do a Li wf optimization in a basis of shifted correlated Gaussians



Mass = [0.500039104068 3.91040678074e-5 3.91040678074e-5;
        3.91040678074e-5 0.500039104068 3.91040678074e-5;
        3.91040678074e-5 3.91040678074e-5 0.500039104068];

Charge = [-3 1 1 -3 1 -3]';

% symmetry projection terms
%Sym = zeros(3,3,6)
% (1)(2)(3)
Sym(:,:,1) = [1 0 0; 0 1 0; 0 0 1];
% (12)
Sym(:,:,2) = [0 1 0; 1 0 0; 0 0 1];
% (13)
Sym(:,:,3) = [0 0 1; 0 1 0; 1 0 0];
% (23)
Sym(:,:,4) = [1 0 0; 0 0 1; 0 1 0];
% (123)
Sym(:,:,5) = [0 1 0; 0 0 1; 1 0 0];
% (132)
Sym(:,:,6) = [0 0 1; 1 0 0; 0 1 0];

% coeff's
symc = [4.0 4.0 -2.0 -2.0 -2.0 -2.0]';

n=3;
nb=8;

xvechL=[
1.10493788484030
-1.69723073340004
-2.03261690776655
 0.41816537468487
 0.49643838405955
-1.23798733791022
 0.77236785269457
-0.82814670764202
-1.53992564086114
-0.46190669097603
 0.19039746287435
-0.52896156890855
-0.15884425973206
 0.09185271544515
 0.45198309025313
 0.02559354230622
-1.22053977357525
 0.05784960153630
-0.43511497318993
-0.51743704505407
 0.29039549520363
 0.40972994488944
-0.28478315854661
 0.52448784656118
-1.54226090016067
 0.33208594746696
-0.43051581531163
 2.38919714537836
 0.83461794406881
 1.26825558805811
-0.27777894284111
 0.46534636562117
-0.12927690692361
 0.51255247203324
-0.19513556676928
-0.35435993616615
-0.85885043502977
-1.06466895960961
-0.98639855836040
 1.11329913795008
-0.22776117390664
 0.61575604134100
-1.16313873074320
-0.53092285395495
 1.02609304169346
-0.65822023751636
-0.35925934319148
 0.32578465809954
 ];


evec = [
  0.07984402546652
  0.93853601577624
  0.97481715119202
  0.75186008436226
  0.51243787655255
  0.54339121866198
  0.77621205187226
  0.79595581712013
  ];
  

x1 = [xvechL' evec']';

%cg_energyrc(x1,n,nb,Mass,Charge,Sym,symc)

%global n nb Mass Charge Sym symc

%  global n nb Mass Charge Sym symc;
  f = @(x)cg_energyrc(x,n,nb,Mass,Charge,Sym,symc);

%f(x1)
%options(1)=1;
options = optimset('Display','iter');
%x0 = x1;
fminsearch(f,x1,options)
